# Common Prefixes

@prefix : <#> .
@prefix ibm: <http://localhost/ldbbc/ibm-vocab.ttl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd:   <http://www.w3.org/2001/XMLSchema#> .
@prefix sp: <http://spinrdf.org/sp#> .
@prefix http: <http://www.w3.org/2011/http#>.
@prefix http_m: <http://www.w3.org/2011/http-methods#>.


# Workflow-specific Prefixes
@prefix button-state: <http://localhost:8080/button/state#> .
@prefix worker: <http://localhost:8080/worker/> .
@prefix worker-state: <http://localhost:8080/worker/state#> .


:MyWorkflowModel
    a ibm:WorkflowModel ;
    ibm:containsStageModel :DoSomething .

# Guards
:PressButton
    a ibm:Guard ;
    ibm:hasCondition :ButtonIsPressed .
    
    
# Stages
:DoSomething
    a ibm:StageModel ;
    ibm:hasGuard :PressButton ;
    ibm:hasMilestone :DidSomething ;
    ibm:hasTaskModel :WorkingTask .

# Tasks
:WorkingTask
    a ibm:TaskModel ;
    ibm:hasHttpRequest [
        a http:Request ;
        http:mthd http_m:POST ;
        http:requestURI worker:doWork ;
        http:body ""^^xsd:string
    ] .

# Milestones
:DidSomething
    a ibm:Milestone ;
    ibm:hasCondition :SomethingIsDone .    


# Sentries
:ButtonIsPressed 
    a sp:Ask ;
    sp:where ([
        sp:subject button-state:Btn ;
        sp:predicate button-state:isPressed ;
        sp:object "true"^^xsd:boolean 
    ]) .

:SomethingIsDone
    a sp:Ask ;
    sp:where ([
        sp:subject worker-state:Worker ;
        sp:predicate worker-state:didSomething ;
        sp:object "true"^^xsd:boolean 
    ]) .