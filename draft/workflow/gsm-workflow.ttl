# Common Prefixes

@prefix : <#> .
@prefix gsm: <http://tok450s.lan:8080/ldbbc/gsm-vocab.ttl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd:   <http://www.w3.org/2001/XMLSchema#> .
@prefix sp: <http://spinrdf.org/sp#> .
@prefix http: <http://www.w3.org/2011/http#>.
@prefix http_m: <http://www.w3.org/2011/http-methods#>.


# Workflow-specific Prefixes
@prefix example: <http://example.org#> . 
@prefix btnstate: <http://localhost/button/state#> .
@prefix worker: <http://localhost/worker/> .
@prefix workstate: <http://localhost/worker/state#> .


:MyWorkflowModel
    a gsm:WorkflowModel ;
    gsm:containsStageModel :DoSomething .

# Guards
:PressButton
    a gsm:Guard ;
    gsm:hasCondition :ButtonIsPressed .
    
    
# Stages
:DoSomething
    a gsm:StageModel ;
    gsm:hasGuard :PressButton ;
    gsm:hasMilestoneModel :DidSomething ;
    gsm:hasTaskModel :WorkingTask .

# Tasks
:WorkingTask
    a gsm:TaskModel ;
    gsm:hasHttpRequest [
        a http:Request ;
        http:mthd http_m:POST ;
        http:requestURI worker:doWork ;
        http:body ""^^xsd:string
    ] .

# Milestones
:DidSomething
    a gsm:MilestoneModel ;
    gsm:hasAchievingSentry :SomethingIsDone ;    
    #gsm:hasInvalidatingSentry :Reset .    
    gsm:hasInvalidatingSentry :ButtonIsNotPressed .

# Sentries
:ButtonIsPressed 
    a sp:Ask ;
    sp:where ([
        sp:subject btnstate:Btn ;
        sp:predicate btnstate:isPressed ;
        sp:object "true"^^xsd:boolean 
    ]) .

:ButtonIsNotPressed 
    a sp:Ask ;
    sp:where ([
        sp:subject btnstate:Btn ;
        sp:predicate btnstate:isPressed ;
        sp:object "false"^^xsd:boolean 
    ]) .

:Reset
    a sp:Ask ;
    sp:where ([
        sp:subject workstate:Worker ;
        sp:predicate workstate:didSomething ;
        sp:object "false"^^xsd:boolean 
    ]) .

:SomethingIsDone
    a sp:Ask ;
    sp:where ([
        sp:subject workstate:Worker ;
        sp:predicate workstate:didSomething ;
        sp:object "true"^^xsd:boolean 
    ]) .