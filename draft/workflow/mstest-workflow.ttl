@prefix : <#> .
@prefix gsm: <http://tok450s.lan:8080/ldbbc/gsm-vocab.ttl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd:   <http://www.w3.org/2001/XMLSchema#> .
@prefix sparql-result: <http://www.w3.org/2005/sparql-results#> .
@prefix sp: <http://spinrdf.org/sp#> .
@prefix http: <http://www.w3.org/2011/http#>.
@prefix http_m: <http://www.w3.org/2011/http-methods#>.


# Workflow-specific Prefixes
@prefix mock: <http://mock-server.lan:3000/mock/rdf#> .
@prefix rfid-bright: <http://t2-rest-bright.lan/#> .
@prefix rfid-dark: <http://t2-rest-dark.lan/#> .
@prefix rfid-ambient: <http://t2-rest-rfid-ambient.lan/rfid#> .
@prefix ambient-light: <http://t2-rest-rfid-ambient.lan/ambient/light#> .
@prefix ambient-sound: <http://t2-rest-rfid-ambient.lan/ambient/sound#> .
@prefix speaker: <http://t2-rest-speaker.lan/#> .



# Workflow
:MSTestWorkflowModel
    a gsm:WorkflowModel ;
    gsm:containsStageModel 
        :Stage1. 


# Guards
:G1 
    a gsm:Guard ;
    gsm:hasCondition :S1 .

# Stages
:Stage1
    a gsm:StageModel ;
    gsm:hasGuard :G1 ;
    gsm:hasMilestoneModel :C1, :C2, :C3 ;
    gsm:hasTaskModel :Task1 .


# Tasks
:Task1 
    a gsm:TaskModel ;
    gsm:hasHttpRequest [
        a http:Request ;
        http:mthd http_m:POST ;
        http:requestURI <http://t2-rest-speaker.lan> ;
        http:body "{\"http://schema.org/text\":\"Task done. Activate milestone now.\"}"^^xsd:string
    ] .

# Milestones
:C1
    a gsm:MilestoneModel ;
    gsm:hasValidatingSentry :V1 ;
    gsm:hasInvalidatingSentry :I1 .

:C2
    a gsm:MilestoneModel ;
    gsm:hasValidatingSentry :V2 ;
    gsm:hasInvalidatingSentry :I2 .

:C3
    a gsm:MilestoneModel ;
    gsm:hasValidatingSentry :V3 ;
    gsm:hasInvalidatingSentry :I3 .


# dummy milestone for stages with no explicit milestone
:CX
    a gsm:MilestoneModel ;
    gsm:hasValidatingSentry :AlwaysTrue ;
    gsm:hasInvalidatingSentry :HighTemperatureDetected .


# Sentries

:S1
    a sp:Ask ;
    sp:where ([
        sp:subject mock:Fire ;
        sp:predicate <http://example.org/extinguished> ;
        sp:object "true"^^xsd:boolean
    ]) .


:V1
    a sp:Ask ;
    sp:where ([
        sp:subject mock:AlarmButton ;
        sp:predicate <http://example.org/isPressed> ;
        sp:object "true"^^xsd:boolean
    ]) .

:I1
    a sp:Ask ;
    sp:where ([
        sp:subject mock:AlarmButton ;
        sp:predicate <http://example.org/isPressed> ;
        sp:object "false"^^xsd:boolean
    ]) .

:V2
    a sp:Ask ;
    sp:where ([
        sp:subject mock:Emergency ;
        sp:predicate <http://example.org/isArrived> ;
        sp:object "true"^^xsd:boolean
    ]) .

:I2
    a sp:Ask ;
    sp:where ([
        sp:subject mock:Emergency ;
        sp:predicate <http://example.org/isArrived> ;
        sp:object "false"^^xsd:boolean
    ]) .

:V3
    a sp:Ask ;
    sp:where ([
        sp:subject mock:People ;
        sp:predicate <http://example.org/evacuated> ;
        sp:object "true"^^xsd:boolean
    ]) .

:I3
    a sp:Ask ;
    sp:where ([
        sp:subject mock:People ;
        sp:predicate <http://example.org/evacuated> ;
        sp:object "false"^^xsd:boolean
    ]) .

